import{d as w,r as d,a as _,c,b as a,t as l,w as g,e as h,f as i,v as u,u as y,o as p,_ as b}from"./index-D_IbfUJW.js";import{l as k,r as P}from"./auth-DVO-hNf6.js";const x={class:"auth-container"},S={class:"auth-box"},V={class:"subtitle"},L={class:"form-group"},q={class:"form-group"},B={key:0,class:"form-group"},C=["disabled"],D={class:"switch-mode"},I=w({__name:"Login",setup(N){const m=y(),n=d(!1),t=d(!0),e=_({username:"",password:"",confirmPassword:""}),f=async()=>{try{n.value=!0;const o=await k({username:e.username,password:e.password});if(o.code===200&&o.data){const s=o.data.token;if(!s){alert("登录失败：未获取到token");return}localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(o.data.user)),console.log("[登录] 成功获取token:",s),m.push("/home")}else alert(o.message||"登录失败")}catch(o){console.error("登录失败:",o),alert("登录失败，请检查网络连接")}finally{n.value=!1}},v=async()=>{if(e.password!==e.confirmPassword){alert("两次输入的密码不一致");return}try{n.value=!0;const o=await P({username:e.username,password:e.password,confirmPassword:e.confirmPassword});o.code===200?(alert("注册成功，请登录"),t.value=!0,e.username="",e.password="",e.confirmPassword=""):alert(o.message||"注册失败")}catch(o){console.error("注册失败:",o),alert("注册失败，请检查网络连接")}finally{n.value=!1}};return(o,s)=>(p(),c("div",x,[a("div",S,[a("h2",null,l(t.value?"欢迎回来":"创建账号"),1),a("p",V,l(t.value?"请登录您的账号":"注册新账号"),1),a("form",{onSubmit:s[3]||(s[3]=g(r=>t.value?f():v(),["prevent"]))},[a("div",L,[i(a("input",{type:"text",placeholder:"用户名","onUpdate:modelValue":s[0]||(s[0]=r=>e.username=r),required:""},null,512),[[u,e.username]])]),a("div",q,[i(a("input",{type:"password",placeholder:"密码","onUpdate:modelValue":s[1]||(s[1]=r=>e.password=r),required:""},null,512),[[u,e.password]])]),t.value?h("",!0):(p(),c("div",B,[i(a("input",{type:"password",placeholder:"确认密码","onUpdate:modelValue":s[2]||(s[2]=r=>e.confirmPassword=r),required:""},null,512),[[u,e.confirmPassword]])])),a("button",{type:"submit",disabled:n.value,class:"submit-btn"},l(n.value?t.value?"登录中...":"注册中...":t.value?"登录":"注册"),9,C)],32),a("div",D,[a("span",null,l(t.value?"还没有账号？":"已有账号？"),1),a("button",{class:"switch-btn",onClick:s[4]||(s[4]=r=>t.value=!t.value)},l(t.value?"立即注册":"立即登录"),1)])])]))}}),R=b(I,[["__scopeId","data-v-ae6e33e7"]]);export{R as default};
